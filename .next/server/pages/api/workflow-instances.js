"use strict";(()=>{var e={};e.id=408,e.ids=[408],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6555:e=>{e.exports=import("uuid")},1044:(e,t,s)=>{s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{config:()=>u,default:()=>c,routeModule:()=>w});var a=s(1802),o=s(7153),i=s(6249),n=s(5282),l=e([n]);n=(l.then?(await l)():l)[0];let c=(0,i.l)(n,"default"),u=(0,i.l)(n,"config"),w=new a.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/workflow-instances",pathname:"/api/workflow-instances",bundlePath:"",filename:""},userland:n});r()}catch(e){r(e)}})},4217:(e,t,s)=>{s.d(t,{O:()=>i});let r=require("@supabase/supabase-js"),a="https://rpudkaqdoguytyweytww.supabase.co",o="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJwdWRrYXFkb2d1eXR5d2V5dHd3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDgxNDI3NTMsImV4cCI6MjA2MzcxODc1M30.GWu-jUQXMU94kTuGx9aK5aG_xNVjJFq9lbrcLUW8HBA";if(!a||!o)throw Error("Missing Supabase environment variables");let i=(0,r.createClient)(a,o,{auth:{persistSession:!1,autoRefreshToken:!1},global:{fetch:fetch}})},5282:(e,t,s)=>{s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{default:()=>handler});var a=s(4217),o=s(6555),i=e([o]);async function handler(e,t){let s={user:{id:"demo-user-123"}};if(!s)return t.status(401).json({message:"Unauthorized"});if("GET"===e.method)try{let{data:e,error:s}=await a.O.from("workflow_instances").select(`
          *,
          workflow:workflows(*)
        `).order("started_at",{ascending:!1});if(s)throw s;return t.status(200).json(e)}catch(e){return console.error("Error fetching workflow instances:",e),t.status(500).json({message:"Failed to fetch workflow instances"})}if("POST"===e.method)try{let{workflowId:r,clientId:i,clientName:n}=e.body;if(!r)return t.status(400).json({message:"Workflow ID is required"});let{data:l,error:c}=await a.O.from("workflows").select(`
          *,
          steps:workflow_steps(*)
        `).eq("id",r).single();if(c)return t.status(404).json({message:"Workflow not found"});let u=(0,o.v4)(),w=new Date().toISOString(),{error:d}=await a.O.from("workflow_instances").insert({id:u,workflow_id:r,started_by:s.user.id,started_at:w,status:"in_progress",current_step_index:0,client_id:i||null,client_name:n||null,total_execution_time_ms:0,human_time_spent_ms:0,ai_processing_time_ms:0,client_wait_time_ms:0,total_cost:0});if(d)throw d;let{data:f,error:_}=await a.O.from("workflow_instances").select(`
          *,
          workflow:workflows(
            *,
            steps:workflow_steps(*)
          )
        `).eq("id",u).single();if(_)throw _;return t.status(201).json(f)}catch(e){return console.error("Error creating workflow instance:",e),t.status(500).json({message:"Failed to create workflow instance"})}return t.status(405).json({message:"Method not allowed"})}o=(i.then?(await i)():i)[0],r()}catch(e){r(e)}})}};var t=require("../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[222],()=>__webpack_exec__(1044));module.exports=s})();