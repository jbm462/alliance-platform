"use strict";(()=>{var e={};e.id=635,e.ids=[635],e.modules={2885:e=>{e.exports=require("@supabase/supabase-js")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},2079:e=>{e.exports=import("openai")},7433:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{config:()=>d,default:()=>u,routeModule:()=>c});var o=r(1802),s=r(7153),n=r(6249),i=r(7272),l=e([i]);i=(l.then?(await l)():l)[0];let u=(0,n.l)(i,"default"),d=(0,n.l)(i,"config"),c=new o.PagesAPIRouteModule({definition:{kind:s.x.PAGES_API,page:"/api/workflows/[id]/execute",pathname:"/api/workflows/[id]/execute",bundlePath:"",filename:""},userland:i});a()}catch(e){a(e)}})},7272:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{default:()=>handler});var o=r(9492),s=r(6357),n=e([s]);async function handler(e,t){let r;if("POST"!==e.method)return t.status(405).json({error:"Method not allowed"});let{id:a}=e.query,{stepId:n,inputs:i}=e.body,{data:l,error:u}=await o.O.from("workflow_steps").select("*").eq("id",n).single();if(u||!l)return t.status(404).json({error:"Step not found"});let d=0,c=0;try{if("AI_EXECUTE"===l.type){let e=await (0,s.We)(l,i);r=e.content,d=e.cost,c=e.tokens}else r=i.result||"Completed by human";let{data:e,error:a}=await o.O.from("step_executions").insert({workflow_instance_id:i.workflowInstanceId,step_id:n,result:r,cost:d,tokens:c,completed_at:new Date().toISOString()}).select().single();if(a)throw a;return t.status(200).json({execution:e})}catch(e){return console.error("Error executing step:",e),t.status(500).json({error:e instanceof Error?e.message:"Failed to execute step"})}}s=(n.then?(await n)():n)[0],a()}catch(e){a(e)}})}};var t=require("../../../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[222,895],()=>__webpack_exec__(7433));module.exports=r})();