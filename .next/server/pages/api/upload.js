"use strict";(()=>{var e={};e.id=39,e.ids=[39],e.modules={2885:e=>{e.exports=require("@supabase/supabase-js")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6705:e=>{e.exports=import("formidable")},7147:e=>{e.exports=require("fs")},3745:(e,r,a)=>{a.a(e,async(e,t)=>{try{a.r(r),a.d(r,{config:()=>d,default:()=>u,routeModule:()=>p});var i=a(1802),s=a(7153),o=a(6249),l=a(3178),n=e([l]);l=(n.then?(await n)():n)[0];let u=(0,o.l)(l,"default"),d=(0,o.l)(l,"config"),p=new i.PagesAPIRouteModule({definition:{kind:s.x.PAGES_API,page:"/api/upload",pathname:"/api/upload",bundlePath:"",filename:""},userland:l});t()}catch(e){t(e)}})},9492:(e,r,a)=>{a.d(r,{O:()=>o});var t=a(2885);let i="https://rpudkaqdoguytyweytww.supabase.co",s="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJwdWRrYXFkb2d1eXR5d2V5dHd3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDgxNDI3NTMsImV4cCI6MjA2MzcxODc1M30.GWu-jUQXMU94kTuGx9aK5aG_xNVjJFq9lbrcLUW8HBA";if(!i||!s)throw Error("Missing Supabase environment variables");let o=(0,t.createClient)(i,s)},3178:(e,r,a)=>{a.a(e,async(e,t)=>{try{a.r(r),a.d(r,{config:()=>u,default:()=>handler});var i=a(9492),s=a(6705),o=a(7147),l=a.n(o),n=e([s]);s=(n.then?(await n)():n)[0];let u={api:{bodyParser:!1}};async function handler(e,r){if("POST"!==e.method)return r.status(405).json({error:"Method not allowed"});try{let a=(0,s.default)({}),[t,o]=await a.parse(e),n=Array.isArray(o.file)?o.file[0]:o.file;if(!n)return r.status(400).json({error:"No file provided"});let u=l().readFileSync(n.filepath,"utf-8"),d=`${Date.now()}-${n.originalFilename}`,{data:p,error:c}=await i.O.storage.from("uploads").upload(d,u);if(c)return r.status(400).json({error:c.message});let f=function(e){let r=e.split("\n").filter(e=>e.trim());if(0===r.length)return[];let a=r[0].split(",").map(e=>e.trim());return r.slice(1).map(e=>{let r=e.split(","),t={};return a.forEach((e,a)=>{t[e]=r[a]?.trim()||""}),t}).filter(e=>Object.values(e).some(e=>e))}(u);return r.status(200).json({fileUrl:p.path,processes:f,preview:f.slice(0,5)})}catch(e){return console.error("Upload error:",e),r.status(500).json({error:e instanceof Error?e.message:"Upload failed"})}}t()}catch(e){t(e)}})}};var r=require("../../webpack-api-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),a=r.X(0,[222],()=>__webpack_exec__(3745));module.exports=a})();