"use strict";(()=>{var e={};e.id=991,e.ids=[991],e.modules={2885:e=>{e.exports=require("@supabase/supabase-js")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6555:e=>{e.exports=import("uuid")},617:(e,r,t)=>{t.a(e,async(e,o)=>{try{t.r(r),t.d(r,{config:()=>u,default:()=>l,routeModule:()=>w});var s=t(1802),a=t(7153),i=t(6249),n=t(9522),d=e([n]);n=(d.then?(await d)():d)[0];let l=(0,i.l)(n,"default"),u=(0,i.l)(n,"config"),w=new s.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/workflows",pathname:"/api/workflows",bundlePath:"",filename:""},userland:n});o()}catch(e){o(e)}})},9492:(e,r,t)=>{t.d(r,{O:()=>i});var o=t(2885);let s="https://rpudkaqdoguytyweytww.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJwdWRrYXFkb2d1eXR5d2V5dHd3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDgxNDI3NTMsImV4cCI6MjA2MzcxODc1M30.GWu-jUQXMU94kTuGx9aK5aG_xNVjJFq9lbrcLUW8HBA";if(!s||!a)throw Error("Missing Supabase environment variables");let i=(0,o.createClient)(s,a)},9522:(e,r,t)=>{t.a(e,async(e,o)=>{try{t.r(r),t.d(r,{default:()=>handler});var s=t(9492),a=t(6555),i=e([a]);async function handler(e,r){if("GET"===e.method)try{let{data:e,error:t}=await s.O.from("workflows").select(`
          *,
          steps:workflow_steps(*)
        `).order("created_at",{ascending:!1});if(t)throw t;return r.status(200).json(e)}catch(e){return console.error("Error fetching workflows:",e),r.status(500).json({message:"Failed to fetch workflows"})}if("POST"===e.method)try{let{title:t,description:o,steps:i,version:n,versionNotes:d,authorId:l}=e.body;if(!t||!o||!i||!Array.isArray(i))return r.status(400).json({message:"Invalid workflow data"});let u=(0,a.v4)(),w=new Date().toISOString(),{error:c}=await s.O.from("workflows").insert({id:u,title:t,description:o,author_id:l||"anonymous",created_at:w,updated_at:w,version:n||"1.0",version_notes:d||"",is_public:!1,category:"custom"});if(c)throw c;let p=i.map((e,r)=>({id:(0,a.v4)(),workflow_id:u,order_index:r,type:e.type,label:e.label,system_prompt:e.systemPrompt||void 0,user_prompt:e.userPrompt||void 0,instructions:e.instructions||void 0,created_at:w,updated_at:w})),{error:f}=await s.O.from("workflow_steps").insert(p);if(f)throw f;let{data:m,error:_}=await s.O.from("workflows").select(`
          *,
          steps:workflow_steps(*)
        `).eq("id",u).single();if(_)throw _;return r.status(201).json(m)}catch(e){return console.error("Error creating workflow:",e),r.status(500).json({message:"Failed to create workflow"})}return r.status(405).json({message:"Method not allowed"})}a=(i.then?(await i)():i)[0],o()}catch(e){o(e)}})}};var r=require("../../webpack-api-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),t=r.X(0,[222],()=>__webpack_exec__(617));module.exports=t})();