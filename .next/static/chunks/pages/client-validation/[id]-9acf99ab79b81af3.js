(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[604],{7649:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/client-validation/[id]",function(){return t(6569)}])},6569:function(e,s,t){"use strict";t.r(s),t.d(s,{__N_SSP:function(){return h},default:function(){return _id_}});var l=t(5893),a=t(7294),i=t(9008),n=t.n(i),r=t(8387);let d=(0,r.Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),c=(0,r.Z)("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]);var o=t(9735),m=t(6345),x=t(1203),h=!0,_id_=e=>{let{validation:s,error:t}=e,[i,r]=(0,a.useState)([]),[h,u]=(0,a.useState)(!1),[p,f]=(0,a.useState)(""),[y,j]=(0,a.useState)(!1),g=s&&("expired"===s.status||new Date(s.expires_at)<new Date),N=s&&"completed"===s.status,removeFile=e=>{r(i.filter((s,t)=>t!==e))},handleSubmit=async e=>{if(e.preventDefault(),s){if(0===i.length){f("Please select at least one file to upload");return}u(!0),f("");try{let e=new FormData;i.forEach(s=>{e.append("file",s)});let t=await Promise.all(i.map(async e=>{let t=new FormData;t.append("file",e),t.append("instanceId",s.instance_id),t.append("stepId",s.step_id);let l=await fetch("/api/file-upload",{method:"POST",body:t});if(!l.ok)throw Error("Failed to upload ".concat(e.name));return e.name})),l=await fetch("/api/client-validations/".concat(s.id),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({files:t})});if(!l.ok){let e=await l.json();throw Error(e.message||"Failed to complete validation")}j(!0)}catch(e){console.error("Error submitting validation:",e),f(e instanceof Error?e.message:"An unknown error occurred")}finally{u(!1)}}};return t?(0,l.jsxs)("div",{className:"min-h-screen bg-gray-100 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[(0,l.jsx)(n(),{children:(0,l.jsx)("title",{children:"Error | Client Upload"})}),(0,l.jsx)("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:(0,l.jsx)("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:(0,l.jsx)("div",{className:"rounded-md bg-red-50 p-4",children:(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:(0,l.jsx)(d,{className:"h-5 w-5 text-red-400"})}),(0,l.jsxs)("div",{className:"ml-3",children:[(0,l.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),(0,l.jsx)("p",{className:"mt-2 text-sm text-red-700",children:t})]})]})})})})]}):s?(0,l.jsxs)("div",{className:"min-h-screen bg-gray-100 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[(0,l.jsx)(n(),{children:(0,l.jsxs)("title",{children:["Client Upload | ",s.instance.workflow.title]})}),(0,l.jsxs)("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[(0,l.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Secure Upload Portal"}),(0,l.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600",children:s.instance.workflow.title})]}),(0,l.jsx)("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:(0,l.jsx)("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:g?(0,l.jsx)("div",{className:"rounded-md bg-yellow-50 p-4",children:(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:(0,l.jsx)(d,{className:"h-5 w-5 text-yellow-400"})}),(0,l.jsxs)("div",{className:"ml-3",children:[(0,l.jsx)("h3",{className:"text-sm font-medium text-yellow-800",children:"This upload link has expired"}),(0,l.jsx)("p",{className:"mt-2 text-sm text-yellow-700",children:"Please contact the person who sent you this link for assistance."})]})]})}):N?(0,l.jsx)("div",{className:"rounded-md bg-green-50 p-4",children:(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:(0,l.jsx)(c,{className:"h-5 w-5 text-green-400"})}),(0,l.jsxs)("div",{className:"ml-3",children:[(0,l.jsx)("h3",{className:"text-sm font-medium text-green-800",children:"Upload completed"}),(0,l.jsx)("p",{className:"mt-2 text-sm text-green-700",children:"Thank you for providing the requested files. You may close this page."})]})]})}):y?(0,l.jsx)("div",{className:"rounded-md bg-green-50 p-4",children:(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:(0,l.jsx)(c,{className:"h-5 w-5 text-green-400"})}),(0,l.jsxs)("div",{className:"ml-3",children:[(0,l.jsx)("h3",{className:"text-sm font-medium text-green-800",children:"Files uploaded successfully"}),(0,l.jsx)("p",{className:"mt-2 text-sm text-green-700",children:"Thank you for providing the requested files. You may close this page."})]})]})}):(0,l.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-700 mb-4",children:s.instance.workflow.description}),(0,l.jsx)("p",{className:"text-sm text-gray-700 mb-4",children:"Please upload any relevant documents that will help us understand your processes better. This could include organization charts, process documentation, time studies, or other materials."}),(0,l.jsxs)("p",{className:"text-xs text-gray-500 mb-6",children:["This secure link will expire on ",new Date(s.expires_at).toLocaleDateString(),"."]})]}),(0,l.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-md p-6 flex flex-col items-center",children:[(0,l.jsx)(o.Z,{className:"h-8 w-8 text-gray-400"}),(0,l.jsx)("p",{className:"mt-1 text-sm text-gray-600",children:"Upload files"}),(0,l.jsx)("input",{type:"file",multiple:!0,onChange:e=>{e.target.files&&(r(Array.from(e.target.files)),f(""))},className:"mt-2 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-medium file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100"})]}),i.length>0&&(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"text-sm font-medium text-gray-700",children:"Selected Files:"}),(0,l.jsx)("ul",{className:"mt-2 divide-y divide-gray-200",children:i.map((e,s)=>(0,l.jsxs)("li",{className:"py-2 flex justify-between items-center",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(m.Z,{className:"h-5 w-5 text-gray-400 mr-2"}),(0,l.jsx)("span",{className:"text-sm text-gray-700",children:e.name}),(0,l.jsxs)("span",{className:"ml-2 text-xs text-gray-500",children:["(",(e.size/1024).toFixed(0)," KB)"]})]}),(0,l.jsx)("button",{type:"button",onClick:()=>removeFile(s),className:"text-gray-400 hover:text-gray-500",children:(0,l.jsx)(x.Z,{className:"h-5 w-5"})})]},s))})]}),p&&(0,l.jsx)("div",{className:"rounded-md bg-red-50 p-4",children:(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:(0,l.jsx)(d,{className:"h-5 w-5 text-red-400"})}),(0,l.jsx)("div",{className:"ml-3",children:(0,l.jsx)("p",{className:"text-sm text-red-700",children:p})})]})}),(0,l.jsx)("button",{type:"submit",disabled:h||0===i.length,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:h?"Uploading...":"Upload Files"})]})})})]}):(0,l.jsxs)("div",{className:"min-h-screen bg-gray-100 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[(0,l.jsx)(n(),{children:(0,l.jsx)("title",{children:"Loading | Client Upload"})}),(0,l.jsx)("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:(0,l.jsx)("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:(0,l.jsx)("p",{className:"text-center text-sm text-gray-500",children:"Loading..."})})})]})}},9008:function(e,s,t){e.exports=t(9201)},8387:function(e,s,t){"use strict";t.d(s,{Z:function(){return createLucideIcon$1}});var l=t(7294),a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();var createLucideIcon$1=(e,s)=>{let t=(0,l.forwardRef)(({color:t="currentColor",size:i=24,strokeWidth:n=2,absoluteStrokeWidth:r,children:d,...c},o)=>(0,l.createElement)("svg",{ref:o,...a,width:i,height:i,stroke:t,strokeWidth:r?24*Number(n)/Number(i):n,className:`lucide lucide-${toKebabCase(e)}`,...c},[...s.map(([e,s])=>(0,l.createElement)(e,s)),...(Array.isArray(d)?d:[d])||[]]));return t.displayName=`${e}`,t}},6345:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});var l=t(8387);let a=(0,l.Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},9735:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});var l=t(8387);let a=(0,l.Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},1203:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});var l=t(8387);let a=(0,l.Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])}},function(e){e.O(0,[774,888,179],function(){return e(e.s=7649)}),_N_E=e.O()}]);